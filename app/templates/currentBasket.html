<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Devine - Jewelry Store</title>
  <link rel="stylesheet" href="login.css">
  <link rel="stylesheet" href="basketStyle.css">
</head>
<body>
  <header>
    <div class="logo">
      <img src="Images/hpic.png" alt="The Devine Logo">
    </div>
  </header>
  <nav class="navbar navbar_bg">
    <ul class="menu">
      <li><a href="homepage.html">Home</a></li>
      <li><a href="products.html">Shop Our Products</a></li>  
      <li><a href="aboutus.html">About Us</a></li>
      <li><a href="contact.html">Contact Us</a></li>
      <li><a href="currentBasket.html">Basket</a></li>
      <li><a href="login.html">Login</a></li>
      <li><a href="register.html">Registration</a></li>
    </ul>

    <div class="search-bar">
      <input type="text" placeholder="Search..." />
      <button type="button" style="font-size: 15px;"><i class="fa-solid fa-magnifying-glass"></i></button>
    </div>

    <div class="hamburger" onclick="toggleMenu(event)">
      <div></div>
      <div></div>
      <div></div>
    </div>
  </nav>

  <div class="cart">
    <a href="Payment.html" id="cart-link">My Cart (0 Items)</a>
  </div>

  <main class="container basket-page">
    <div class="order-summary-container">
      <h2 class="section-title">Order Summary</h2>
      <ul id="order-summary-list">
        <li>Basket is empty</li>
      </ul>
      <p id="order-total"><strong>Total: £0.00</strong></p>
      <button class="btn-primary" onclick="showPromoPopup()">Enter Promo Code</button>
      <button class="btn-primary">Checkout</button>
    </div>
  <br>
    <div class="recommended-products">
      <h2 class="section-title">Recommended Products:</h2>
      <div class="product-grid">
        <div class="product-details">
          <img src="Images/leaf ring 1.webp" alt="Elegant leaf design">
          <h2>Elegant leaf design</h2>
          <p>£150.00</p>
          <button class="btn-primary add-btn" data-name="Elegant leaf design" data-price="150.00">Add to Cart</button>
        </div>
        <div class="product-details">
          <img src="Images/crystal_ring_1.jpg" alt="Crystal ring">
          <h2>Crystal ring</h2>
          <p>£180.00</p>
          <button class="btn-primary add-btn" data-name="Crystal ring" data-price="180.00">Add to Cart</button>
        </div>
        <div class="product-details">
          <img src="Images/pearl necklace 1.webp" alt="Pearl necklace">
          <h2>Pearl necklace</h2>
          <p>£250.00</p>
          <button class="btn-primary add-btn" data-name="Pearl necklace" data-price="250.00">Add to Cart</button>
        </div>
      </div>
    </div>
  </main>
  

  <footer class="footer">
    <p>&copy; The Devine 2024</p>
  </footer>

  <div id="promo-popup" class="popup hidden">
    <span id="close-popup" class="close">&times;</span>
    <h2>Enter Promo Code</h2>
    <input type="text" id="promo-code-input" placeholder="Enter code">
    <button class="btn-primary" onclick="applyPromoCode()">Apply</button>
  </div>

  <div id="success-popup" class="popup hidden">Congratulations! 20% off!</div>
  <div id="error-popup" class="popup hidden">Mmm... not quite!</div>

  <script>
let cartItems = [];
let totalAmount = 0;

function addToCart(itemName, itemPrice, itemImage) {
  const existingItemIndex = cartItems.findIndex((item) => item.name === itemName);
  if (existingItemIndex !== -1) {
    cartItems[existingItemIndex].quantity += 1;
  } else {
    cartItems.push({ name: itemName, price: itemPrice, image: itemImage, quantity: 1 });
  }
  totalAmount += itemPrice;
  updateCart();
  updateOrderSummary();
}

function updateCart() {
  document.getElementById("cart-link").innerText = `My Cart (${cartItems.length} Items)`;
}

function updateOrderSummary() {
  const orderSummaryList = document.getElementById("order-summary-list");
  const orderTotal = document.getElementById("order-total");

  orderSummaryList.innerHTML = cartItems.length ? "" : "<li>Basket is empty</li>";

  cartItems.forEach((item, index) => {
    const listItem = document.createElement("li");
    listItem.innerHTML = `
      <img src="${item.image}" alt="${item.name}" class="basket-item-img">
      <span>${item.name} - £${(item.price * item.quantity).toFixed(2)}</span>
      <div class="quantity-controls">
        <button onclick="decreaseQuantity(${index})">-</button>
        <span class="item-quantity">${item.quantity}</span>
        <button onclick="increaseQuantity(${index})">+</button>
      </div>`;
    orderSummaryList.appendChild(listItem);
  });

  orderTotal.innerHTML = `<strong>Total: £${totalAmount.toFixed(2)}</strong>`;
}

function increaseQuantity(index) {
  cartItems[index].quantity += 1;
  totalAmount += cartItems[index].price;
  updateOrderSummary();
}

function decreaseQuantity(index) {
  if (cartItems[index].quantity > 1) {
    cartItems[index].quantity -= 1;
    totalAmount -= cartItems[index].price;
  } else {
    totalAmount -= cartItems[index].price;
    cartItems.splice(index, 1);
  }
  updateOrderSummary();
}

function removeFromCart(index) {
  totalAmount -= cartItems[index].price * cartItems[index].quantity;
  cartItems.splice(index, 1);
  updateCart();
  updateOrderSummary();
}

function showPromoPopup() {
  document.getElementById("promo-popup").classList.remove("hidden");
}

function closePopup() {
  document.getElementById("promo-popup").classList.add("hidden");
}

function applyPromoCode() {
  const code = document.getElementById("promo-code-input").value;
  if (code === "TEAM20") {
    showMessage("success-popup");
    totalAmount *= 0.8;
    updateOrderSummary();
  } else {
    showMessage("error-popup");
  }
}

function showMessage(popupId) {
  const popup = document.getElementById(popupId);
  popup.classList.remove("hidden");
  setTimeout(() => {
    popup.classList.add("hidden");
  }, 6000);
}

document.getElementById("close-popup").addEventListener("click", closePopup);

document.querySelectorAll(".add-btn").forEach((btn) =>
  btn.addEventListener("click", (event) => {
    const name = event.target.dataset.name;
    const price = parseFloat(event.target.dataset.price);
    const image = event.target.closest(".product-details").querySelector("img").src;
    addToCart(name, price, image);
  })
);
  </script>
</body>
</html>
